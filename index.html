<!DOCTYPE html>




<html class="theme-next mist" lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hello World">










<meta name="description" content="随便写写">
<meta property="og:type" content="website">
<meta property="og:title" content="model">
<meta property="og:url" content="http://modelpi.com/index.html">
<meta property="og:site_name" content="model">
<meta property="og:description" content="随便写写">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="model">
<meta name="twitter:description" content="随便写写">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":false,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://modelpi.com/">





  <title>model</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">model</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">no cross no crown</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://modelpi.com/letcode/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liuxiaokun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="model">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/letcode/" itemprop="url">leetCode--两数之和和两数相加</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-01-02T19:56:30+08:00">
                2019-01-02
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/letcode/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/letcode/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="两数之和"><a href="#两数之和" class="headerlink" title="两数之和"></a>两数之和</h2><h3 id="1-题目"><a href="#1-题目" class="headerlink" title="1.题目"></a>1.题目</h3><p>Given an array of integers, return <strong>indices</strong> of the two numbers such that they add up to a specific target.</p>
<p>You may assume that each input would have <strong>exactly</strong> one solution, and you may not use the <em>same</em>element twice.</p>
<p><strong>Example:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Given nums = [2, 7, 11, 15], target = 9,</span><br><span class="line"></span><br><span class="line">Because nums[0] + nums[1] = 2 + 7 = 9,</span><br><span class="line">return [0, 1].</span><br></pre></td></tr></table></figure>
<h4 id="分析："><a href="#分析：" class="headerlink" title="分析："></a>分析：</h4><p>就是给定一个数，在列表中找到两个数的和是这个，把下标输出出来。最简单的方式就是用for循环，比如下面的代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">list=[]</span><br><span class="line">numsLen = len(nums)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(numsLen):</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> range(i+<span class="number">1</span>,numsLen):</span><br><span class="line">        <span class="keyword">if</span> nums[i]+nums[k]==target:</span><br><span class="line">            list.append(i)</span><br><span class="line">            list.append(k)</span><br><span class="line">            <span class="keyword">return</span> list</span><br><span class="line"> <span class="keyword">return</span> <span class="keyword">None</span></span><br></pre></td></tr></table></figure>
<p>这个最好理解的，就是for循环，从第一个开始循环，然后再循环剩下的数入，如果两个数加起来是目标数值，就返回。在一个从小到大有序的数组是非常快。但是如果这个数组中数值是无序就比较慢了（只能跑赢20%左右的python代码）。</p>
<p>下面给出一个无序比较快的一段查找代码：<br>​    </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a=&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i,value <span class="keyword">in</span> enumerate(nums):</span><br><span class="line">    <span class="keyword">if</span> target-value <span class="keyword">in</span> a:</span><br><span class="line">        <span class="keyword">return</span> [a[target-value],i]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        a[value] = i</span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> <span class="keyword">None</span></span><br></pre></td></tr></table></figure>
<p>这个代码的思路，一次循环就能做出来，用了字典，key是数组的值，value是数组的下标。然后利用字典的查询特点快速找到值，取出下标(跑赢100%)。    </p>
<h2 id="两个列表之和"><a href="#两个列表之和" class="headerlink" title="两个列表之和"></a>两个列表之和</h2><h4 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h4><p>You are given two <strong>non-empty</strong> linked lists representing two non-negative integers. The digits are stored in <strong>reverse order</strong> and each of their nodes contain a single digit. Add the two numbers and return it as a linked list.</p>
<p>You may assume the two numbers do not contain any leading zero, except the number 0 itself.</p>
<p><strong>Example:</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: (<span class="number">2</span> -&gt; <span class="number">4</span> -&gt; <span class="number">3</span>) + (<span class="number">5</span> -&gt; <span class="number">6</span> -&gt; <span class="number">4</span>)</span><br><span class="line">Output: <span class="number">7</span> -&gt; <span class="number">0</span> -&gt; <span class="number">8</span></span><br><span class="line">Explanation: <span class="number">342</span> + <span class="number">465</span> = <span class="number">807.</span></span><br></pre></td></tr></table></figure>
<h4 id="分析：-1"><a href="#分析：-1" class="headerlink" title="分析："></a>分析：</h4><p>就是把两个链表上的数值相加，最终得到一个链表的值。有点像竖式运算。所以就只能循环链表，把数值相加。注意，超过9的话会进1。简单的代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cur = result =ListNode(<span class="number">0</span>)</span><br><span class="line"> a=<span class="number">0</span></span><br><span class="line"> <span class="keyword">while</span> l1 <span class="keyword">or</span> l2 <span class="keyword">or</span> a != <span class="number">0</span>:</span><br><span class="line">     k = (l1.val <span class="keyword">if</span> l1 <span class="keyword">else</span> <span class="number">0</span>) + (l2.val <span class="keyword">if</span> l2 <span class="keyword">else</span> <span class="number">0</span>) + a</span><br><span class="line">     a = k / <span class="number">10</span></span><br><span class="line">     cur.next = ListNode(k % <span class="number">10</span>)</span><br><span class="line">     cur = cur.next</span><br><span class="line">     l1 = l1.next <span class="keyword">if</span> l1 <span class="keyword">else</span> <span class="keyword">None</span></span><br><span class="line">     l2 = l2.next <span class="keyword">if</span> l2 <span class="keyword">else</span> <span class="keyword">None</span></span><br><span class="line"> <span class="keyword">return</span> result.next</span><br></pre></td></tr></table></figure>
<p>这个里面就是有很多判断条件，只能跑赢40%左右的python代码，下面又做了一些改进</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">cur = result =ListNode(<span class="number">0</span>)</span><br><span class="line">      carry=<span class="number">0</span></span><br><span class="line">      a=<span class="number">0</span></span><br><span class="line">      <span class="keyword">while</span> l1 <span class="keyword">and</span> l2:</span><br><span class="line">          k = l1.val+l2.val+carry</span><br><span class="line">          carry=k//<span class="number">10</span></span><br><span class="line">          cur.next=ListNode(k%<span class="number">10</span>)</span><br><span class="line">          cur = cur.next</span><br><span class="line">          l1 = l1.next</span><br><span class="line">          l2 = l2.next</span><br><span class="line">      <span class="keyword">while</span> l1:</span><br><span class="line">          k = carry+l1.val</span><br><span class="line">          carry=k//<span class="number">10</span></span><br><span class="line">          cur.next=ListNode(k%<span class="number">10</span>)</span><br><span class="line">          cur = cur.next</span><br><span class="line">          l1 = l1.next</span><br><span class="line">      <span class="keyword">while</span> l2:</span><br><span class="line">          k = carry+l2.val</span><br><span class="line">          carry=k//<span class="number">10</span></span><br><span class="line">          cur.next=ListNode(k%<span class="number">10</span>)</span><br><span class="line">          cur = cur.next</span><br><span class="line">          l2 = l2.next</span><br><span class="line">      <span class="keyword">if</span> carry!=<span class="number">0</span>:</span><br><span class="line">          cur.next=ListNode(carry)</span><br><span class="line">          cur = cur.next</span><br><span class="line">      <span class="keyword">return</span> root.next</span><br></pre></td></tr></table></figure>
<p>这个代码比上一个代码只能提升一点点，怎么能跑赢超过一半的python代码，不知道大家有没有比较好的想法，可以交流一下</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://modelpi.com/excelcolor/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liuxiaokun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="model">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/excelcolor/" itemprop="url">scala利用poi给Excel添加颜色</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-12-31T13:25:30+08:00">
                2018-12-31
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/excelcolor/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/excelcolor/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>上次利用poi导出Excel，写了一个Excel的工具类，感觉还是挺好用的。但是有一个问题，Excel的头部是白色和下面的内容的颜色是一样的。这看着怎么可以。于是想着添加一下背景色</p>
<h4 id="掉坑"><a href="#掉坑" class="headerlink" title="掉坑"></a>掉坑</h4><p>Excel的处理逻辑从大到小，首先创建一个工作簿（sheet），然后创建里面的行（row），在行中创建单元格（cell），然后在cell中赋值这样Excel中的值就来。</p>
<p>所以我认为cell对象中直接设置背景颜色的方法setcolor这个方法。然而没有。只有一个setCellStyle的方法，传入的对象XSSFCellStyle，那只能创建这个对象。注意这个对象是用<strong>XSSFWorkbook</strong>创建的。</p>
<p>找到这个对象之后，看一下有没有关于颜色的方法，找到两个<strong>setFillForegroundColor</strong>和<strong>setFillBackgroundColor</strong>，看到方法肯定用setFillBackgroundColor，但是万万没有想到，直接把cell中内容覆盖了。所以使用setFillForegroundColor这个方法试一下，最后成功了，然后看api中介绍，发现api中介绍：many cells are actually filled with a foreground fill。</p>
<p>看到这个方法用的是XSSFColor对象，那就再new一下，看一下XSSFColor的对象和方法：发现一个public XSSFColor(Color clr)构造方法，注意这里面的Color对象是<strong>java.awt.Color</strong>而不是<strong>org.apache.poi.ss.usermodel.Color</strong>，可以直接用Color.RED设置红色。我调色的时候喜欢用rgb的数值来确定颜色，于是找到XSSFColor有setRGB方法，感觉离成功不远了，下面贴一下代码供大家参考</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> style = xssf.createCellStyle()</span><br><span class="line"><span class="keyword">val</span> color =<span class="keyword">new</span> <span class="type">XSSFColor</span>()</span><br><span class="line">color.setRGB(<span class="type">Array</span>(<span class="number">189.</span>toByte,<span class="number">183.</span>toByte,<span class="number">107.</span>toByte))</span><br><span class="line">style.setFillForegroundColor(color)</span><br><span class="line">style.setFillPattern(<span class="type">FillPatternType</span>.<span class="type">SOLID_FOREGROUND</span>)</span><br><span class="line">cell.setCellStyle(style)</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://modelpi.com/huishouqi/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liuxiaokun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="model">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/huishouqi/" itemprop="url">垃圾回收器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-12-31T12:30:30+08:00">
                2018-12-31
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/huishouqi/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/huishouqi/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="垃圾回收器"><a href="#垃圾回收器" class="headerlink" title="垃圾回收器"></a>垃圾回收器</h2><h3 id="1-串行回收器"><a href="#1-串行回收器" class="headerlink" title="1.串行回收器"></a>1.串行回收器</h3><p>串行回收器是指使用单线程进行垃圾回收的回收器，每次回收只有一个线程，专注性和独占性有更好的性能表现，可以在新生代和老年代使用，所以可以分为新生代串行回收器和老年代串行回收器</p>
<h4 id="1-1新生代串行回收器"><a href="#1-1新生代串行回收器" class="headerlink" title="1.1新生代串行回收器"></a>1.1新生代串行回收器</h4><h5 id="特点："><a href="#特点：" class="headerlink" title="特点："></a>特点：</h5><p>单线程进行垃圾回收，独占式的垃圾回收。新生代串行回收器采用复制算法，实现简单，处理高兴，没有线程切换开销。在某些场景下超越并行回收器和并发回收器（比如单cpu等）</p>
<p>当串行回收器进行垃圾回收，java中的所有线程都会暂停，所以实时性要求高的应用场景，不能被接收</p>
<p>使用-XX:+UseSerialGC可以指定新生代串行回收器或者老年代串行回收器，当虚拟机在Client模式下，默认的垃圾回收器</p>
<h4 id="1-2老年代串行回收器"><a href="#1-2老年代串行回收器" class="headerlink" title="1.2老年代串行回收器"></a>1.2老年代串行回收器</h4><h5 id="特点：-1"><a href="#特点：-1" class="headerlink" title="特点："></a>特点：</h5><p>老年代串行回收器使用的标记压缩算法，也是一个串行独占的垃圾回收器，由于老年代垃圾回收时间一般比新生代要长，所以停顿时间也可以比较长</p>
<p>-XX:+UseSerialGC：新生代和老年代都使用串行回收器</p>
<p>-XX:+UseParNewGC：新生代使用ParNew回收器，老年代都使用串行回收器</p>
<p>-XX:+UseParallelGC：新生代使用Parallel回收器，老年代都使用串行回收器</p>
<h3 id="2-并行回收器"><a href="#2-并行回收器" class="headerlink" title="2.并行回收器"></a>2.并行回收器</h3><p>并行回收器在串行基础上做了改进，使用多个线程同时进行垃圾回收，对于并行能力较强的计算，可以有效缩短垃圾回收所需的实际时间</p>
<h4 id="2-1新生代ParNew回收器"><a href="#2-1新生代ParNew回收器" class="headerlink" title="2.1新生代ParNew回收器"></a>2.1新生代ParNew回收器</h4><p>ParNew回收器是用于新生代垃圾回收，它只是简单地将串行回收器多线程化，回收策略，算法和参数和新生代串行回收器一样。ParNew也是一个独占式的回收器，所以应用程序会全部暂停，但是在并发能力较强的机器上，回收时间要短于串行回收器</p>
<p>-XX:+UseConcMarkSweepGC：新生代使用ParNew回收器，老年代使用CMS</p>
<p>-XX:ParallelGCThreads：ParNew回收器线程数量。</p>
<h4 id="2-2新生代ParallelGC回收器"><a href="#2-2新生代ParallelGC回收器" class="headerlink" title="2.2新生代ParallelGC回收器"></a>2.2新生代ParallelGC回收器</h4><p>从表面上看和ParNew回收器一样，使用复制算法，多线程和独占式的收集器。它有一个很重要的特点就是关注系统的吞吐量。有两个重要的参数：</p>
<p>-XX:MaxGCPauseMills:设置最大垃圾回收的停顿时间</p>
<p>-XX:GCTimeRatio: 设置吞吐量的大小，默认值是99，就是1%(1/(1+99))的时间用于垃圾收集</p>
<p>-XX:UseAdaptiveSizePolicy 是一种自适应的GC调节策略，在这种模式下，新生代的大小，end和survivior的比例，晋升老年代的对象年龄参数都会自动调整已达到堆大小，吞吐量和停顿之间的平衡点。</p>
<p><strong>注意：</strong>-XX:MaxGCPauseMills和-XX:GCTimeRatio是两个互相矛盾的参数。</p>
<h4 id="2-3老年代ParallelOldGC回收器"><a href="#2-3老年代ParallelOldGC回收器" class="headerlink" title="2.3老年代ParallelOldGC回收器"></a>2.3老年代ParallelOldGC回收器</h4><p>老年代ParallelOldGC回收器也是多线程并发的收集器，关注吞吐量的一个回收器。用的是比较压缩算法，其余参数和ParallelGC回收器类似，一个用于新生代一个用于老年代。</p>
<h3 id="3-CMS回收器"><a href="#3-CMS回收器" class="headerlink" title="3.CMS回收器"></a>3.CMS回收器</h3><p>CMS是Concurrent Mark Sweep的缩写，意思是并发标记清除，它使用的标记清除算法，同时又是一个多线程并行回收的垃圾回收器。</p>
<h4 id="回收步骤"><a href="#回收步骤" class="headerlink" title="回收步骤"></a>回收步骤</h4><ol>
<li>初始标记：独占资源，标记跟对象</li>
<li>并发标记：标记所有对象</li>
<li>预清理：清理准备以及控制停顿时间</li>
<li>重新标记：独占资源，修正并发标记对象</li>
<li>并发清理：清理垃圾</li>
<li>并发重置</li>
</ol>
<p>根据标记清除算法：初始标记，并发标记和重新标记都是标记清除的对象。并发清理则是正式回收垃圾对象，并发重置是在垃圾回收完成后，重新初始化cms数据结构和数据</p>
<h4 id="主要参数"><a href="#主要参数" class="headerlink" title="主要参数"></a>主要参数</h4><p>-XX:+UseConcMarkSweepGC 启用cms垃圾回收器</p>
<p>-XX:ConcMarkThreads 并发线程数</p>
<p>-XX:+CMSInitiatingOccupancyFraction 内存空间使用阈值，默认68%，达到阈值时会进行垃圾回收</p>
<p>-XX:+UseFullGCsBeforeCompaction:回收多少次后，进行内存压缩</p>
<p>-XX:+UseCMSCompactAtFullCollection 使CMS垃圾回收之后进行内存碎片整理，注意内存碎片整理不是并发的</p>
<h3 id="4-G1回收器"><a href="#4-G1回收器" class="headerlink" title="4.G1回收器"></a>4.G1回收器</h3><p>G1回收器是从jdk7开始正式使用的回收器，回收还是分年轻代和老年代。但是它使用分区算法，其特点如下：</p>
<p><strong>并行性：</strong> 垃圾回收期间，可以多个GC线程同时进行</p>
<p><strong>并发性：</strong>程序和GC交替进行，所以不会完全阻塞程序</p>
<p><strong>分代GC：</strong>G1依然是一个分代回收器，兼顾年轻代和老年代。</p>
<p><strong>空间整理：</strong>在回收过程中会进行适当的空间移动，有效的复制对象，减少空间碎片</p>
<p><strong>可预见性：</strong>由于分区的原因，可以选择部分区域进行回收，所以全局停顿可以得到很好的控制</p>
<p>注意：并行：程序会停顿，多线程同时进行，并发：程序和回收交替进行。</p>
<p>G1的回收过程可能有4个阶段：</p>
<p>新生代GC，并发标记周期，混合收集，可能会进行full GC</p>
<h5 id="1-新生代GC"><a href="#1-新生代GC" class="headerlink" title="1.新生代GC"></a>1.新生代GC</h5><p>新生代GC是主要工作是回收eden区和survivor区，一旦eden区被占满，新生代GC就会启动。新生代GC只处理eden区和survivor区，回收之后所有eden区都应该被清空，survivor区清除一部分。还有一个变化就是年老代会增多</p>
<h5 id="2-并发标记周期"><a href="#2-并发标记周期" class="headerlink" title="2.并发标记周期"></a>2.并发标记周期</h5><p>并发标记周期可以分为以下步骤：</p>
<p><strong>初始标记：</strong>标记从根节点可以直接到达的对象，它伴随着一次新生代GC,会产生停顿，应用程序在这个线程中会停顿</p>
<p><strong>根区域扫描：</strong>这个可以跟应用程序一起运行</p>
<p><strong>并发标记：</strong>查找整个堆的存活对象，并做好标记</p>
<p><strong>重新标记：</strong>并发过程中程序依然进行，结果可能需要修正，重新标记，对上次结果进行补充，为了加快标记速度，会创建一个快照。</p>
<p><strong>独占清理：</strong>这个阶段会引起停顿，它计算各个区域存活对象和GC回收比例进行排序，识别可供回收的区域。会标记可以混合回收区域，混合回收阶段会需要这些信息</p>
<p><strong>并发清理阶段：</strong>识别并清理完全空闲区域，并发清理，不会引起停顿</p>
<h5 id="3-混合回收："><a href="#3-混合回收：" class="headerlink" title="3.混合回收："></a>3.混合回收：</h5><p>在并发标记周期中会回收一部分对象，但是总体来说还是比例相当低。在并发标记周期中已经知道哪些可以区域可以混合回收，这个阶段就是对这些区域进行回收。会优先回收垃圾比例比较高的区域因为这些区域性价比比较高。它会回收年轻大和老年代区域。</p>
<p>4.必要时full GC</p>
<p>并发收集和应用程序交替运行，这样就不能避免在特别繁忙的场合出现回收过程中内存不足情况。当遇到这种情况G1就会进行full GC</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://modelpi.com/scala导出Excel及所遇到的问题/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liuxiaokun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="model">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/scala导出Excel及所遇到的问题/" itemprop="url">scala利用poi导出Excel</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-12-25T20:01:30+08:00">
                2018-12-25
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/scala导出Excel及所遇到的问题/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/scala导出Excel及所遇到的问题/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>今天做了scala把数据库的数据按照需求导出Excel中，遇到一些问题和坑，记录下来遇到的大家分享。首先一个贴上一个粗糙的demo，大家可以借鉴一下。</p>
<p>利用Apache poi包进行处理，用的是4.0.1，依赖包：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml-schemas<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="代码："><a href="#代码：" class="headerlink" title="代码："></a>代码：</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建file</span></span><br><span class="line">    <span class="keyword">val</span> file = <span class="keyword">new</span> <span class="type">File</span>(<span class="string">"/Users/xk/Desktop/a.xlsx"</span>)</span><br><span class="line">    <span class="comment">//val ps = new POIFSFileSystem(new BufferedInputStream(new FileInputStream("/Users/xk/Desktop/a.xlsx")))</span></span><br><span class="line">    <span class="comment">//判断file是否存在，不存在创建</span></span><br><span class="line">    <span class="keyword">if</span>(!file.exists())&#123;</span><br><span class="line">      <span class="keyword">try</span>&#123;</span><br><span class="line">        file.createNewFile()</span><br><span class="line">       <span class="comment">// WorkbookFactory.create(new FileInputStream("/Users/xk/Desktop/a.xlsx"))</span></span><br><span class="line">      &#125;<span class="keyword">catch</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> ex:<span class="type">IOException</span>=&gt;&#123;</span><br><span class="line">          println(<span class="string">"error"</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//excel处理Excel的类</span></span><br><span class="line">    <span class="keyword">val</span> hssf = <span class="keyword">new</span> <span class="type">XSSFWorkbook</span>()</span><br><span class="line">    <span class="comment">//创建一个工作簿</span></span><br><span class="line">    <span class="keyword">val</span> sheet = hssf.createSheet(<span class="string">"student"</span>)</span><br><span class="line">    <span class="comment">//创建第一行，一般都是的头部</span></span><br><span class="line">    <span class="keyword">val</span> firstRow = sheet.createRow(<span class="number">0</span>)</span><br><span class="line">    <span class="comment">//设置行头</span></span><br><span class="line">    <span class="keyword">val</span> heads = <span class="type">Array</span>[<span class="type">String</span>](<span class="string">"名字"</span>,<span class="string">"年龄"</span>,<span class="string">"班级"</span>)</span><br><span class="line">    <span class="comment">//设置头部</span></span><br><span class="line">    <span class="keyword">for</span>(i&lt;- <span class="number">0</span> until heads.length)&#123;</span><br><span class="line">      <span class="keyword">val</span> cell = firstRow.createCell(i)</span><br><span class="line">      cell.setCellValue(<span class="keyword">new</span> <span class="type">XSSFRichTextString</span>(heads(i)))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> rowlist = parkDF.collect().toList</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(i &lt;- <span class="number">0</span> until rowlist.length)&#123;</span><br><span class="line">      <span class="keyword">val</span> erow = sheet.createRow(i+<span class="number">1</span>)</span><br><span class="line">      <span class="keyword">val</span> xlsDot = rowlist(i)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="keyword">val</span> sortCell = erow.createCell(<span class="number">0</span>)</span><br><span class="line">      sortCell.setCellValue(xlsDot.getString(<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">      <span class="keyword">val</span> sortCell1 = erow.createCell(<span class="number">1</span>)</span><br><span class="line">      sortCell1.setCellValue(xlsDot.getString(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">      <span class="keyword">val</span> sortCell2 = erow.createCell(<span class="number">2</span>)</span><br><span class="line">      sortCell2.setCellValue(xlsDot.getString(<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> out = <span class="keyword">new</span> <span class="type">FileOutputStream</span>(<span class="string">"/Users/xk/Desktop/a.xlsx"</span>)</span><br><span class="line">    hssf.write(out)</span><br><span class="line">    out.close()</span><br><span class="line">    <span class="comment">//in.close()</span></span><br><span class="line">    hssf.close()</span><br></pre></td></tr></table></figure>
<p>遇到的坑：</p>
<p><code>org.apache.poi.poifs.filesystem.NotOLE2FileException</code></p>
<p>之前用的HSSFWorkbook类处理Excel，发现这个类只处理2007版之前的Excel，可以看成后缀是<strong>xls</strong>的Excel文件，后缀为<strong>xlsx</strong>需要用XSSFWorkbook，这个类不在poi包，需要引用poi-ooxml和poi-ooxml-schemas包</p>
<p><code>org.apache.poi.EmptyFileException: The supplied file was empty (zero bytes long)</code></p>
<p>看到网上例子，创建XSSFWorkbook的时候，有用fileInputStream参数创建的。我就用了val hssf = new XSSFWorkbook(new FileInputStream(“/Users/g2/Desktop/a.xlsx”))的方式报错，结果一直报这个错误，去掉流的参数就可以了</p>
<p>#### </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://modelpi.com/垃圾回收算法/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liuxiaokun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="model">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/垃圾回收算法/" itemprop="url">垃圾回收算法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-12-24T20:01:30+08:00">
                2018-12-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/垃圾回收算法/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/垃圾回收算法/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="垃圾回收算法"><a href="#垃圾回收算法" class="headerlink" title="垃圾回收算法"></a>垃圾回收算法</h2><h3 id="1引用计数法"><a href="#1引用计数法" class="headerlink" title="1引用计数法"></a>1引用计数法</h3><h4 id="思想："><a href="#思想：" class="headerlink" title="思想："></a>思想：</h4><p>对象A引用了就加1，引用失效了就减1，当引用数为0时，就可以回收</p>
<h4 id="缺点："><a href="#缺点：" class="headerlink" title="缺点："></a>缺点：</h4><p>1、无法处理循环引用情况（对象A引用对象B，对象B引用对象A，但是A和B都没有别的对象引用）</p>
<p>2、引用计数器要求每次引用产生和消除的时候，都伴随着加法和减法的操作，对系统有一定的影响。</p>
<h3 id="2标记清除算法"><a href="#2标记清除算法" class="headerlink" title="2标记清除算法"></a>2标记清除算法</h3><p>标记清除算法是现代回收算法的基础思想，在介绍之前先解释两个名词：</p>
<p><strong>可达对象</strong>：通过根对象进行引用搜索，最终可以搜索到的对象</p>
<p><strong>不可达对象</strong>：通过根对象进行搜索，最终没有被引用的对象</p>
<p><strong>新生代：</strong>存放年轻的对象堆空间，年轻的对象指刚刚创建或者经理回收次数不多的对象</p>
<p><strong>老年代：</strong>存放老年的对象的堆空间，老年对象指经历过多次垃圾回收依然存货的对象</p>
<h4 id="思想：-1"><a href="#思想：-1" class="headerlink" title="思想："></a>思想：</h4><p>分为两个阶段，标记和清除。标记阶段：标记所有根对象可到达对象，未被标记的对象就是垃圾对象，清除阶段：系统回收不可到达的空间</p>
<h4 id="缺点：-1"><a href="#缺点：-1" class="headerlink" title="缺点："></a>缺点：</h4><p>回收后空间是不连续的。当再分配空间时，特别是大对象的时候，不连续的空间要低于连续的空间。</p>
<h3 id="3-复制算法"><a href="#3-复制算法" class="headerlink" title="3.复制算法"></a>3.复制算法</h3><h4 id="思想：-2"><a href="#思想：-2" class="headerlink" title="思想："></a>思想：</h4><p>将原有的内存空间分成两块，每次只使用其中一块，在垃圾回收的时候，将正在使用的对象复制到未使用的内存中</p>
<h4 id="优点："><a href="#优点：" class="headerlink" title="优点："></a>优点：</h4><p>如果系统中垃圾对象比较多，需要复制存活的比较少，效率比较高。还有就是复制对象到新的内存空间空间是连续的</p>
<p>在java中新生代串行垃圾回收器中使用这个算法。新生代有分为eden区，from区和to区。其中from和to是两个相同大小的空间。</p>
<h4 id="适用于："><a href="#适用于：" class="headerlink" title="适用于："></a>适用于：</h4><p>使用在新生代中，因为新生代中垃圾对象通常会多于存活对象</p>
<h3 id="4标记压缩算法"><a href="#4标记压缩算法" class="headerlink" title="4标记压缩算法"></a>4标记压缩算法</h3><h4 id="思想：-3"><a href="#思想：-3" class="headerlink" title="思想："></a>思想：</h4><p>标记压缩算法，标记也是从根节点开始，对所有的可达对象进行标记。然后把所有存活对象压缩到内存的一段，清理边界外的空间。这样空间是连续的，没有碎片产生。所以看成标记清除算法+空间整理</p>
<h4 id="适用于：-1"><a href="#适用于：-1" class="headerlink" title="适用于："></a>适用于：</h4><p>年老代通常使用这种算法，年老代对象大多情况下都是存活对象，如果在使用复制算法，复制成本比较高。</p>
<h3 id="5分代算法"><a href="#5分代算法" class="headerlink" title="5分代算法"></a>5分代算法</h3><h4 id="思想：-4"><a href="#思想：-4" class="headerlink" title="思想："></a>思想：</h4><p>由于复制，标记压缩，标记清除各有优缺点。根据回收垃圾对象的特性，使用不同的算法这样比较好。基于这种思想，内存空间根据对象的特点分成不通的区间，对应不同的算法。</p>
<p>一般内存分代，分成老年代和年轻代。老年代用于标记压缩算法和标记清除算法，新生代用于复制算法。老年代回收频率比较低，新生代回收频率比较高。</p>
<h3 id="6分区算法"><a href="#6分区算法" class="headerlink" title="6分区算法"></a>6分区算法</h3><h4 id="思想：-5"><a href="#思想：-5" class="headerlink" title="思想："></a>思想：</h4><p>分代算法是根据对象的存活时间，分区则是把堆空间分成连续不同的小区间，每个区间独立使用，独立回收。</p>
<h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><p>一般来说，堆空间越大一次回收越多，从而产生的停顿越长。可以根据目标的停顿时间，每次回收若干个合理的区间，而不是整个空间。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://modelpi.com/github+hexo搭建博客/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liuxiaokun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="model">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/github+hexo搭建博客/" itemprop="url">github+hexo搭建博客</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-12-14T12:18:30+08:00">
                2018-12-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/github+hexo搭建博客/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/github+hexo搭建博客/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p> 终于利用github+hexo搭建完博客，现在聊一下搭建博客历程和遇到的坑。</p>
<h2 id="github创建工程"><a href="#github创建工程" class="headerlink" title="github创建工程"></a>github创建工程</h2><p>   <strong>工程的名字一定要是{你的名字}.github.io，这样你的项目访问的路径才是{你的名字}.github.io,要不然会带上github的域名和普通的项目没有区别</strong></p>
<h2 id="hexo使用"><a href="#hexo使用" class="headerlink" title="hexo使用"></a>hexo使用</h2><p>   <strong>hexo init 如果没有指定目录，会在当前目录下建立网站。如果当前目录不为会报错，也可以指定目录</strong></p>
<h2 id="一般使用的hexo指令"><a href="#一般使用的hexo指令" class="headerlink" title="一般使用的hexo指令"></a>一般使用的hexo指令</h2><p>hexo new  新建一篇文章</p>
<p>hexo clean 清除缓存</p>
<p>hexo generate 生成静态文件 可以简写成hexo g</p>
<p>hexo deploy 部署之前生成的静态文件 简写成 hexo d</p>
<p>我一般改写完之后，都是 hexo g -d</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://modelpi.com/sparksql time处理/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liuxiaokun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="model">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/sparksql time处理/" itemprop="url">sparkSQL 时间和视图处理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-12-14T12:18:30+08:00">
                2018-12-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/sparksql time处理/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/sparksql time处理/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p> 上周利用spark sql统计mysql数据库中数据然后导入mysql的报表库中，遇到了一些时间处理的问题，记录一下mysql和spark sql处理不同。</p>
<h2 id="最近30天处理"><a href="#最近30天处理" class="headerlink" title="最近30天处理"></a>最近30天处理</h2><p>在spark sql中处理：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">date_sub(now(),30) &lt;=create_time</span><br></pre></td></tr></table></figure></p>
<p>在mysql处理:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DATE_SUB(CURDATE(), INTERVAL 30 DAY) &lt;=create_time</span><br></pre></td></tr></table></figure></p>
<h2 id="时间相差几天"><a href="#时间相差几天" class="headerlink" title="时间相差几天"></a>时间相差几天</h2><p>在spark sql处理（和mysql一直）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">datediff(start_time,end_time)&lt;1(天数)</span><br></pre></td></tr></table></figure>
<h2 id="相差多少分钟"><a href="#相差多少分钟" class="headerlink" title="相差多少分钟"></a>相差多少分钟</h2><p>在spark sql先把两个时间转换时间戳，然后再除以60.利用<strong>unix_timestamp</strong>函数进行处理,下面是转换为秒</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unix_timestamp(a.depart_time)-unix_timestamp(a.enter_time)</span><br></pre></td></tr></table></figure>
<h2 id="转换为年月日"><a href="#转换为年月日" class="headerlink" title="转换为年月日"></a>转换为年月日</h2><p>在spark sql用<strong>date_format</strong>进行处理，注意想要####-##-##模式，格式一定要<strong><u>y-MM-dd</u></strong>,这样用时间排序才没有问题，如果是<u><strong>y-M-d</strong></u>，出现的日期格式，排序会有问题</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DATE_FORMAT(create_time, &apos;y-MM-dd&apos;)</span><br></pre></td></tr></table></figure>
<h2 id="spark的视图"><a href="#spark的视图" class="headerlink" title="spark的视图"></a>spark的视图</h2><p>spark的视图创建非常方面，一般使用createOrReplaceTempView方法，创建视图，比如可以这样使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">spark.sql(&quot;select * from </span><br><span class="line">A where deleted=0&quot;).createOrReplaceTempView(&quot;a_view&quot;)</span><br></pre></td></tr></table></figure>
<p>利用视图可以把复杂嵌套的sql分解一个个视图，最后得到想要的结果</p>
<p>注意：视图不能全部数字，会报错。视图如果被使用过，需要重新创建。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">liuxiaokun</p>
              <p class="site-description motion-element" itemprop="description">随便写写</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Imodel" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:liuxiaokun_happy@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-snowflake-o"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">liuxiaokun</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count"></span>
  
</div>









        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i> 访问人数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      人
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i> 总访问量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'YgnpUIegG8AimMJhR2leas5D-gzGzoHsz',
        appKey: 'pz6n88wRgjhVScn2i1nhV0tM',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>





  





  

  

  

  
  

  

  

  

</body>
</html>
